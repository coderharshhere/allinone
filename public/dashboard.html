<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllInOne MP ‚Äì Advanced Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;600;700;800&display=swap');
        :root {
            --primary-color: #1e3a8a;
            --secondary-color: #3b82f6;
            --success-color: #22c55e;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --sidebar-width: 280px;
            --sidebar-collapsed-width: 80px;
            --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Noto Sans Devanagari', sans-serif;
            background: linear-gradient(135deg, #f0f4f8 0%, #e6f7ff 100%);
            overflow-x: hidden;
            color: #1e293b;
            min-height: 100vh;
        }
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
            transition: opacity 0.5s ease;
        }
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(59, 130, 246, 0.2);
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(59, 130, 246, 0.3);
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .sidebar {
            width: var(--sidebar-width);
            transition: var(--transition);
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 40;
            overflow-x: hidden;
            box-shadow: var(--card-shadow);
            background: linear-gradient(180deg, #1e3a8a 0%, #0f296b 100%);
        }
        .sidebar.collapsed {
            width: var(--sidebar-collapsed-width);
        }
        .sidebar.collapsed .sidebar-text {
            display: none;
        }
        .sidebar.collapsed .logo-text {
            display: none;
        }
        .sidebar-toggle-fixed {
            position: fixed;
            left: var(--sidebar-width);
            top: 20px;
            z-index: 50;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0 12px 12px 0;
            padding: 10px 12px;
            cursor: pointer;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            color: var(--primary-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
            height: 42px;
        }
        .sidebar.collapsed + .sidebar-toggle-fixed {
            left: var(--sidebar-collapsed-width);
        }
        .main-content {
            transition: margin-left 0.3s ease;
            margin-left: var(--sidebar-width);
            padding: 20px;
            padding-top: 90px;
        }
        .main-content.sidebar-collapsed {
            margin-left: var(--sidebar-collapsed-width);
        }
        .status-badge {
            padding: 6px 16px;
            border-radius: 50px;
            font-size: 13px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            border: 2px solid transparent;
            transition: var(--transition);
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .status-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .status-complete {
            background-color: #dcfce7;
            color: #166534;
            border-color: #bbf7d0;
        }
        .status-pending {
            background-color: #ffedd5;
            color: #9a3412;
            border-color: #fed7aa;
        }
        .status-reject {
            background-color: #fee2e2;
            color: #991b1b;
            border-color: #fecaca;
        }
        .status-processing {
            background-color: #dbeafe;
            color: #1e40af;
            border-color: #bfdbfe;
        }
        .action-btn {
            padding: 0.6rem;
            border-radius: 10px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border: none;
            cursor: pointer;
            font-size: 1.1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .action-view {
            background-color: rgba(59, 130, 246, 0.15);
            color: #3b82f6;
        }
        .action-edit {
            background-color: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
        }
        .action-delete {
            background-color: rgba(239, 68, 68, 0.15);
            color: #ef4444;
        }
        .action-download {
            background-color: rgba(34, 197, 94, 0.15);
            color: #22c55e;
        }
        .notification-badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background-color: #ef4444;
            color: white;
            font-size: 10px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 0 0 2px white;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 8px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(15px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        .table-row {
            transition: var(--transition);
            border-bottom: 1px solid #f1f5f9;
        }
        .table-row:hover {
            background-color: #f8fafc;
            transform: translateX(5px);
        }
        .page-section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        .page-section.active {
            display: block;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.65);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(4px);
            animation: modalFadeIn 0.3s ease-out;
        }
        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            border-radius: 24px;
            max-width: 950px;
            width: 100%;
            max-height: 95vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
            transform: translateY(0);
            transition: transform 0.4s ease, opacity 0.4s ease;
            opacity: 1;
            animation: modalContentFadeIn 0.4s ease-out;
        }
        @keyframes modalContentFadeIn {
            from { 
                transform: translateY(20px);
                opacity: 0;
            }
            to { 
                transform: translateY(0);
                opacity: 1;
            }
        }
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 28px 32px;
            border-radius: 24px 24px 0 0;
            position: relative;
            overflow: hidden;
        }
        .modal-header::after {
            content: "";
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
        }
        .qr-container {
            background: white;
            padding: 20px;
            border-radius: 16px;
            display: inline-block;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.15);
            border: 1px solid #e2e8f0;
            margin: 15px 0;
        }
        .detail-row {
            display: flex;
            padding: 14px 0;
            border-bottom: 1px dashed #e2e8f0;
        }
        .detail-label {
            font-weight: 700;
            color: #475569;
            width: 40%;
            font-size: 0.95rem;
        }
        .detail-value {
            color: #0f172a;
            font-weight: 600;
            width: 60%;
            font-size: 1rem;
        }
        .stat-card {
            transition: var(--transition);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: var(--card-shadow);
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.05);
        }
        .stat-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }
        .stat-card.pending::before { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .stat-card.complete::before { background: linear-gradient(90deg, #22c55e, #10b981); }
        .stat-card.rejected::before { background: linear-gradient(90deg, #ef4444, #f87171); }
        .search-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 25px;
            transition: var(--transition);
        }
        .search-container:hover {
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.12);
        }
        .filter-badge {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            color: white;
            padding: 4px 12px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.3);
        }
        .chart-container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--card-shadow);
            margin-top: 25px;
            transition: var(--transition);
        }
        .chart-container:hover {
            box-shadow: 0 15px 25px -5px rgba(0, 0, 0, 0.12);
        }
        .form-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-top: 25px;
            display: none;
        }
        .form-section.active {
            display: block;
            animation: fadeIn 0.6s ease-out;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #334155;
            font-size: 0.95rem;
        }
        .form-control {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid #cbd5e1;
            border-radius: 14px;
            font-family: 'Noto Sans Devanagari', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
        }
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 14px;
            font-weight: 700;
            font-size: 1.05rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.55);
        }
        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--secondary-color);
            padding: 12px 26px;
            border-radius: 14px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn-secondary:hover {
            background: #f1f5ff;
            transform: translateY(-2px);
        }
        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }
        .receipt-header {
            text-align: center;
            padding: 25px 0;
            border-bottom: 3px solid #3b82f6;
            margin-bottom: 30px;
            position: relative;
        }
        .receipt-header::after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #3b82f6, transparent);
        }
        .receipt-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            color: white;
            font-weight: 800;
            font-size: 1.8rem;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }
        .receipt-title {
            font-size: 2.2rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 10px 0;
            letter-spacing: -0.5px;
        }
        .receipt-subtitle {
            color: #475569;
            font-size: 1.25rem;
            margin-top: 5px;
        }
        .receipt-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px dashed #cbd5e1;
            font-size: 0.95rem;
        }
        .receipt-footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 25px;
            border-top: 2px solid #e2e8f0;
            color: #475569;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .document-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .document-item {
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: var(--transition);
            background: #f8fafc;
        }
        .document-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border-color: var(--secondary-color);
        }
        .document-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--secondary-color);
        }
        .document-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: #1e293b;
            display: block;
            margin-top: 5px;
        }
        .document-link {
            color: var(--secondary-color);
            font-weight: 600;
            font-size: 0.85rem;
            text-decoration: none;
            display: block;
            margin-top: 5px;
            transition: var(--transition);
        }
        .document-link:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        .service-badge {
            padding: 4px 14px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-block;
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            color: #1e40af;
        }
        .top-bar {
            position: fixed;
            top: 0;
            left: var(--sidebar-width);
            right: 0;
            background: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 30;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: left 0.3s ease;
            height: 70px;
        }
        .sidebar.collapsed + .sidebar-toggle-fixed + .top-bar {
            left: var(--sidebar-collapsed-width);
        }
        .user-card {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 8px 16px;
            border-radius: 16px;
            background: #f1f5ff;
            transition: var(--transition);
            cursor: pointer;
        }
        .user-card:hover {
            background: #e0e7ff;
            transform: translateX(3px);
        }
        .user-avatar {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            flex-shrink: 0;
        }
        .user-info {
            display: flex;
            flex-direction: column;
        }
        .user-name {
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--primary-color);
        }
        .user-email {
            font-size: 0.8rem;
            color: #475569;
        }
        .notification-card {
            position: relative;
            background: white;
            border-radius: 16px;
            padding: 15px;
            box-shadow: var(--card-shadow);
            cursor: pointer;
            transition: var(--transition);
            min-width: 280px;
            margin-left: 15px;
        }
        .notification-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.15);
        }
        .notification-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #f1f5f9;
            margin-bottom: 10px;
        }
        .notification-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 8px;
        }
        .notification-item {
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            gap: 12px;
        }
        .notification-item:last-child {
            border-bottom: none;
        }
        .notification-icon {
            width: 36px;
            height: 36px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.1rem;
        }
        .notification-icon.pending {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
        }
        .notification-icon.complete {
            background: rgba(34, 197, 94, 0.15);
            color: #22c55e;
        }
        .notification-content h4 {
            font-weight: 600;
            margin-bottom: 4px;
            color: #0f172a;
        }
        .notification-content p {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 4px;
        }
        .notification-time {
            font-size: 0.75rem;
            color: #94a3b8;
        }
        .nav-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 14px 20px;
            border-radius: 16px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            position: relative;
            color: #cbd5e1;
        }
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        .nav-item.active {
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            position: relative;
        }
        .nav-item.active::before {
            content: "";
            position: absolute;
            left: 0;
            top: 8px;
            bottom: 8px;
            width: 4px;
            background: white;
            border-radius: 0 4px 4px 0;
        }
        .nav-icon {
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        .sidebar-footer {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
        }
        .logout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 14px;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-family: 'Noto Sans Devanagari', sans-serif;
        }
        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.25);
            transform: translateX(5px);
        }
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #64748b;
        }
        .empty-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            opacity: 0.7;
        }
        .empty-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #334155;
        }
        .empty-message {
            font-size: 1.1rem;
            max-width: 500px;
            margin: 0 auto 25px;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        .data-table th {
            background-color: #f8fafc;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 0.5px;
            color: #334155;
            padding: 16px 12px;
            text-align: left;
        }
        .data-table td {
            padding: 16px 12px;
            vertical-align: middle;
        }
        .data-table tr:last-child td {
            border-bottom: none;
        }
        .auth-error-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            color: white;
            text-align: center;
        }
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                box-shadow: none;
            }
            .sidebar.active {
                transform: translateX(0);
            }
            .main-content {
                margin-left: 0;
                padding-top: 120px;
            }
            .sidebar-collapsed + .sidebar-toggle-fixed {
                left: 0;
            }
            .top-bar {
                left: 0;
                padding: 15px;
            }
            .sidebar.collapsed + .sidebar-toggle-fixed + .top-bar {
                left: 0;
            }
            .data-table {
                min-width: 600px;
            }
            .detail-label, .detail-value {
                width: 100%;
                padding: 8px 0;
            }
            .detail-row {
                flex-direction: column;
                align-items: flex-start;
            }
            .receipt-meta {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

<!-- LOADING SCREEN -->
<div id="loadingScreen" class="loading-screen">
    <div class="loading-spinner"></div>
    <h2 class="text-2xl font-bold text-gray-800 mt-4">AllInOne MP ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä</h2>
    <p class="mt-3 text-gray-600 font-medium text-lg">‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ú‡§æ‡§Ç‡§ö ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...</p>
    <p id="loadingStatus" class="mt-3 text-sm text-blue-600 flex items-center gap-2">
        <i class="fas fa-shield-alt"></i> ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡§∞‡§£ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö...
    </p>
    <div class="mt-6 flex gap-3">
        <div class="w-40 bg-gray-200 rounded-full overflow-hidden">
            <div id="loadingProgress" class="h-2 bg-blue-600" style="width: 15%"></div>
        </div>
        <span id="progressText" class="text-sm font-medium text-gray-700">15%</span>
    </div>
</div>

<!-- AUTH ERROR SCREEN (Hidden by default) -->
<div id="authErrorScreen" class="auth-error-screen" style="display: none;">
    <div class="text-center p-8">
        <i class="fas fa-lock text-6xl mb-6 opacity-80"></i>
        <h1 class="text-3xl font-bold mb-4">üîí ‡§™‡§π‡•Å‡§Ç‡§ö ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§</h1>
        <p class="text-xl mb-2 opacity-90">‡§á‡§∏ ‡§™‡•á‡§ú ‡§ï‡•ã ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§≤‡•â‡§ó‡§ø‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à</p>
        <p class="text-lg opacity-75 mb-8">‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§™‡•ç‡§∞‡§Æ‡§æ‡§£‡•Ä‡§ï‡•É‡§§ ‡§ï‡§∞‡•á‡§Ç</p>
        <a href="https://allinonemp.harshtiwari.in/adminlogin.html" 
           class="bg-white text-blue-900 px-8 py-3 rounded-xl font-bold text-lg hover:bg-blue-50 transition shadow-lg inline-flex items-center gap-2">
            <i class="fas fa-sign-in-alt"></i>
            ‡§≤‡•â‡§ó‡§ø‡§® ‡§™‡•á‡§ú ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç
        </a>
    </div>
</div>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
    <div class="p-6 border-b border-blue-700/50">
        <div class="flex items-center justify-between mb-8">
            <div class="flex items-center gap-3">
                <div class="bg-white/20 backdrop-blur-sm p-2.5 rounded-xl">
                    <div class="bg-white w-11 h-11 rounded-lg flex items-center justify-center shadow-md">
                        <span class="text-blue-900 font-bold text-xl">MP</span>
                    </div>
                </div>
                <div class="logo-text">
                    <h1 class="text-xl font-bold tracking-tight">AllInOne-MP</h1>
                    <p class="text-xs opacity-95 mt-0.5">‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§™‡•à‡§®‡§≤</p>
                </div>
            </div>
            <button class="text-white p-1.5 hover:bg-white/20 rounded-lg transition no-sidebar-text" onclick="toggleSidebar()">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="mb-3 sidebar-text">
            <div class="bg-white/15 backdrop-blur-sm p-4 rounded-xl border border-white/20">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-xs opacity-95 flex items-center gap-1.5">
                            <i class="fas fa-user-shield"></i> ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï
                        </p>
                        <p class="font-bold mt-1.5 text-white text-lg" id="sidebarAdminName">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
                    </div>
                    <div class="bg-yellow-300/90 text-blue-900 font-bold w-10 h-10 rounded-xl flex items-center justify-center text-base shadow-md">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <nav class="mt-2 p-4">
        <div class="px-3 py-2 text-xs font-bold text-blue-200 uppercase tracking-wider mb-3 sidebar-text">‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§Æ‡•á‡§®‡•Ç</div>
        <ul class="space-y-1.5">
            <li>
                <a class="nav-item active" onclick="showSection('dashboard')">
                    <div class="nav-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <span class="sidebar-text">‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§°</span>
                </a>
            </li>
            <li>
                <a class="nav-item" onclick="showSection('applications')">
                    <div class="nav-icon">
                        <i class="fas fa-file-signature"></i>
                    </div>
                    <span class="sidebar-text">‡§Ü‡§µ‡•á‡§¶‡§® ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®</span>
                </a>
            </li>
            <li>
                <a class="nav-item" onclick="showSection('newApplication')">
                    <div class="nav-icon">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <span class="sidebar-text">‡§®‡§Ø‡§æ ‡§Ü‡§µ‡•á‡§¶‡§®</span>
                </a>
            </li>
        </ul>
    </nav>
    <div class="sidebar-footer">
        <button onclick="logout()" class="logout-btn">
            <i class="fas fa-sign-out-alt text-lg"></i> 
            <span class="sidebar-text">‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡•á‡§Ç</span>
        </button>
        <div class="mt-4 text-center text-xs text-blue-100/80 sidebar-text">
            <div>‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ 3.0.0</div>
            <div class="mt-1 flex items-center justify-center gap-1.5">
                <i class="fas fa-shield-alt"></i>
                <span>‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§®</span>
            </div>
        </div>
    </div>
</aside>

<!-- SIDEBAR TOGGLE BUTTON -->
<button class="sidebar-toggle-fixed" onclick="toggleSidebar()" id="sidebarToggleBtn">
    <i class="fas fa-bars" id="toggleIcon"></i>
</button>

<!-- TOP BAR -->
<div class="top-bar" id="topBar">
    <div class="flex items-center gap-4">
        <div class="bg-gray-100 text-gray-600 rounded-xl px-4 py-2.5 flex items-center gap-2">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="‡§Ü‡§µ‡•á‡§¶‡§® ‡§ñ‡•ã‡§ú‡•á‡§Ç..." class="bg-transparent border-none outline-none w-48" id="globalSearch">
        </div>
    </div>
    <div class="user-card">
        <div class="user-avatar" id="topBarAvatar">A</div>
        <div class="user-info">
            <div class="user-name" id="adminName">‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï</div>
            <div class="user-email" id="adminEmail">admin@allinonemp.gov.in</div>
        </div>
        <i class="fas fa-chevron-down text-gray-500 text-sm ml-1"></i>
    </div>
</div>

<!-- MAIN CONTENT -->
<main class="main-content flex-1 transition-all" id="mainContent">

    <!-- DASHBOARD -->
    <div id="dashboard" class="page-section active">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 fade-in">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div>
                        <h1 class="text-2.5xl md:text-3xl font-bold text-gray-800 flex items-center gap-3">
                            <i class="fas fa-tachometer-alt text-blue-600"></i>
                            ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à, <span id="welcomeAdminName" class="text-blue-600">‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï</span>
                        </h1>
                        <p class="text-gray-500 mt-2 text-lg">‡§Ü‡§ú ‡§ï‡•Ä ‡§§‡§æ‡§∞‡•Ä‡§ñ: <span id="currentDate" class="font-medium text-gray-700"></span></p>
                    </div>
                    <div class="flex flex-wrap items-center gap-3">
                        <div class="bg-blue-50 text-blue-800 px-4 py-2.5 rounded-xl font-medium flex items-center gap-2">
                            <i class="fas fa-cloud text-lg"></i>
                            <span>Firebase ‡§∏‡•ç‡§•‡§ø‡§§‡§ø: <span id="firebaseStatus" class="font-bold text-green-600">‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡•á‡§°</span></span>
                        </div>
                        <button onclick="refreshData()" class="btn-primary">
                            <i class="fas fa-sync-alt"></i> ‡§°‡•á‡§ü‡§æ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§ï‡§∞‡•á‡§Ç
                        </button>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                <div class="stat-card bg-white p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium mb-1.5">‡§ï‡•Å‡§≤ ‡§Ü‡§µ‡•á‡§¶‡§®</p>
                            <h3 class="text-3xl font-bold text-gray-800" id="statTotal">0</h3>
                            <p class="text-green-600 font-medium mt-1 flex items-center gap-1.5">
                                <i class="fas fa-arrow-up"></i>
                                <span id="statTotalGrowth">12.5%</span> ‡§™‡§ø‡§õ‡§≤‡•á ‡§Æ‡§æ‡§π ‡§∏‡•á
                            </p>
                        </div>
                        <div class="bg-blue-100 text-blue-600 w-16 h-16 rounded-2xl flex items-center justify-center text-2xl shadow-md">
                            <i class="fas fa-file-alt"></i>
                        </div>
                    </div>
                </div>
                <div class="stat-card bg-white p-6 pending">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium mb-1.5">‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Ü‡§µ‡•á‡§¶‡§®</p>
                            <h3 class="text-3xl font-bold text-gray-800" id="statPending">0</h3>
                            <p class="text-yellow-600 font-medium mt-1 flex items-center gap-1.5">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span id="statPendingCount">15</span> ‡§§‡§§‡•ç‡§ï‡§æ‡§≤ ‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à ‡§π‡•á‡§§‡•Å
                            </p>
                        </div>
                        <div class="bg-yellow-100 text-yellow-600 w-16 h-16 rounded-2xl flex items-center justify-center text-2xl shadow-md">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                </div>
                <div class="stat-card bg-white p-6 complete">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium mb-1.5">‡§∏‡§´‡§≤ ‡§Ü‡§µ‡•á‡§¶‡§®</p>
                            <h3 class="text-3xl font-bold text-gray-800" id="statComplete">0</h3>
                            <p class="text-green-600 font-medium mt-1 flex items-center gap-1.5">
                                <i class="fas fa-check-circle"></i>
                                <span id="statCompleteRate">98.2%</span> ‡§∏‡§´‡§≤‡§§‡§æ ‡§¶‡§∞
                            </p>
                        </div>
                        <div class="bg-green-100 text-green-600 w-16 h-16 rounded-2xl flex items-center justify-center text-2xl shadow-md">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
                <div class="stat-card bg-white p-6 rejected">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium mb-1.5">‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§Ü‡§µ‡•á‡§¶‡§®</p>
                            <h3 class="text-3xl font-bold text-gray-800" id="statRejected">0</h3>
                            <p class="text-red-600 font-medium mt-1 flex items-center gap-1.5">
                                <i class="fas fa-times-circle"></i>
                                <span id="statRejectedRate">1.8%</span> ‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§‡§ø ‡§¶‡§∞
                            </p>
                        </div>
                        <div class="bg-red-100 text-red-600 w-16 h-16 rounded-2xl flex items-center justify-center text-2xl shadow-md">
                            <i class="fas fa-times-circle"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-2xl shadow-lg overflow-hidden fade-in">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                                <th>‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</th>
                                <th class="hidden md:table-cell">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞</th>
                                <th class="hidden md:table-cell">‡§§‡§æ‡§∞‡•Ä‡§ñ</th>
                                <th>‡§∏‡•ç‡§•‡§ø‡§§‡§ø</th>
                                <th>‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à</th>
                            </tr>
                        </thead>
                        <tbody id="dataTable">
                            <tr>
                                <td colspan="7" class="text-center py-12 text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                    <p class="text-lg font-medium">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="p-5 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="text-gray-600">
                        ‡§ï‡•Å‡§≤ <span id="totalRecords">0</span> ‡§Ü‡§µ‡•á‡§¶‡§® ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§ø‡§§ ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
                    </div>
                </div>
            </div>

            <div class="chart-container fade-in">
                <h2 class="text-xl font-bold text-gray-800 mb-5 flex items-center gap-2.5">
                    <i class="fas fa-chart-bar text-blue-600"></i>
                    ‡§Ü‡§µ‡•á‡§¶‡§® ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£
                </h2>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <canvas id="applicationsChart" height="250"></canvas>
                    </div>
                    <div>
                        <canvas id="statusChart" height="250"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW APPLICATION FORM SECTION -->
    <div id="newApplication" class="page-section">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 fade-in">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2.5xl font-bold text-gray-800 flex items-center gap-3">
                            <i class="fas fa-plus-circle text-green-600"></i>
                            ‡§®‡§Ø‡§æ ‡§Ü‡§µ‡•á‡§¶‡§® ‡§´‡•â‡§∞‡•ç‡§Æ
                        </h1>
                        <p class="text-gray-500 mt-1">‡§®‡§è ‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</p>
                    </div>
                    <button onclick="showSection('dashboard')" class="btn-secondary px-5 py-2.5">
                        <i class="fas fa-arrow-left"></i> ‡§µ‡§æ‡§™‡§∏ ‡§ú‡§æ‡§è‡§Ç
                    </button>
                </div>
            </div>
            
            <div class="form-section active">
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <div class="border-b border-gray-200 pb-6 mb-8">
                        <h2 class="text-xl font-bold text-gray-800">‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
                        <p class="text-gray-500 mt-1">‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§î‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç</p>
                    </div>
                    
                    <form id="applicationForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="applicantName">‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ <span class="text-red-500">*</span></label>
                                <input type="text" id="applicantName" class="form-control" placeholder="‡§∞‡§æ‡§Æ‡§∂‡§∞‡§£ ‡§Ø‡§æ‡§¶‡§µ" required>
                            </div>
                            <div class="form-group">
                                <label for="fatherName">‡§™‡§ø‡§§‡§æ/‡§™‡§§‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ <span class="text-red-500">*</span></label>
                                <input type="text" id="fatherName" class="form-control" placeholder="‡§∂‡•ç‡§Ø‡§æ‡§Æ‡§∂‡§∞‡§£ ‡§Ø‡§æ‡§¶‡§µ" required>
                            </div>
                            <div class="form-group">
                                <label for="mobileNumber">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ <span class="text-red-500">*</span></label>
                                <input type="tel" id="mobileNumber" class="form-control" placeholder="9876543210" required>
                            </div>
                            <div class="form-group">
                                <label for="aadharNumber">‡§Ü‡§ß‡§æ‡§∞ ‡§®‡§Ç‡§¨‡§∞ <span class="text-red-500">*</span></label>
                                <input type="text" id="aadharNumber" class="form-control" placeholder="1234 5678 9012" required>
                            </div>
                            <div class="form-group">
                                <label for="dob">‡§ú‡§®‡•ç‡§Æ ‡§§‡§ø‡§•‡§ø <span class="text-red-500">*</span></label>
                                <input type="date" id="dob" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="gender">‡§≤‡§ø‡§Ç‡§ó <span class="text-red-500">*</span></label>
                                <select id="gender" class="form-control" required>
                                    <option value="">‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                    <option value="male">‡§™‡•Å‡§∞‡•Å‡§∑</option>
                                    <option value="female">‡§Æ‡§π‡§ø‡§≤‡§æ</option>
                                    <option value="other">‡§Ö‡§®‡•ç‡§Ø</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="serviceType">‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞ <span class="text-red-500">*</span></label>
                                <select id="serviceType" class="form-control" required>
                                    <option value="">‡§∏‡•á‡§µ‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                    <option value="samagra">‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§Ü‡§à‡§°‡•Ä</option>
                                    <option value="mpbhoj">‡§è‡§Æ‡§™‡•Ä ‡§≠‡•ã‡§ú ‡§Ø‡•ã‡§ú‡§®‡§æ</option>
                                    <option value="scholarship">‡§õ‡§æ‡§§‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø</option>
                                    <option value="pension">‡§™‡•á‡§Ç‡§∂‡§® ‡§Ø‡•ã‡§ú‡§®‡§æ</option>
                                    <option value="housing">‡§Ü‡§µ‡§æ‡§∏ ‡§Ø‡•ã‡§ú‡§®‡§æ</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="district">‡§ú‡§ø‡§≤‡§æ <span class="text-red-500">*</span></label>
                                <select id="district" class="form-control" required>
                                    <option value="">‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</option>
                                    <option value="bhopal">‡§≠‡•ã‡§™‡§æ‡§≤</option>
                                    <option value="indore">‡§á‡§Ç‡§¶‡•å‡§∞</option>
                                    <option value="jabalpur">‡§ú‡§¨‡§≤‡§™‡•Å‡§∞</option>
                                    <option value="gwalior">‡§ó‡•ç‡§µ‡§æ‡§≤‡§ø‡§Ø‡§∞</option>
                                    <option value="ujjain">‡§â‡§ú‡•ç‡§ú‡•à‡§®</option>
                                    <option value="sagar">‡§∏‡§æ‡§ó‡§∞</option>
                                    <option value="ratlam">‡§∞‡§§‡§≤‡§æ‡§Æ</option>
                                    <option value="satna">‡§∏‡§§‡§®‡§æ</option>
                                </select>
                            </div>
                            <div class="form-group md:col-span-2">
                                <label for="address">‡§™‡§§‡§æ <span class="text-red-500">*</span></label>
                                <textarea id="address" class="form-control" rows="3" placeholder="‡§ó‡§≤‡•Ä ‡§®‡§Ç‡§¨‡§∞ 5, ‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞‡•Ä ‡§®‡§ó‡§∞, ‡§≠‡•ã‡§™‡§æ‡§≤, ‡§Æ‡§ß‡•ç‡§Ø ‡§™‡•ç‡§∞‡§¶‡•á‡§∂ - 462001" required></textarea>
                            </div>
                            <div class="form-group">
                                <label for="pincode">‡§™‡§ø‡§® ‡§ï‡•ã‡§° <span class="text-red-500">*</span></label>
                                <input type="text" id="pincode" class="form-control" placeholder="462001" required>
                            </div>
                            <div class="form-group">
                                <label for="email">‡§à‡§Æ‡•á‡§≤ ‡§Ü‡§à‡§°‡•Ä</label>
                                <input type="email" id="email" class="form-control" placeholder="applicant@example.com">
                            </div>
                        </div>
                        
                        <div class="border-t border-gray-200 pt-8 mt-8">
                            <div class="flex justify-end gap-4">
                                <button type="button" onclick="resetForm()" class="btn-secondary px-6 py-3">
                                    <i class="fas fa-redo"></i> ‡§´‡•â‡§∞‡•ç‡§Æ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç
                                </button>
                                <button type="submit" class="btn-primary px-8 py-3 text-lg">
                                    <i class="fas fa-paper-plane"></i> ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- APPLICATIONS MANAGEMENT SECTION -->
    <div id="applications" class="page-section">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6 fade-in">
                <h1 class="text-2.5xl font-bold text-gray-800 flex items-center gap-3">
                    <i class="fas fa-file-signature text-blue-600"></i>
                    ‡§Ü‡§µ‡•á‡§¶‡§® ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä
                </h1>
                <p class="text-gray-500 mt-1">‡§∏‡§≠‡•Ä ‡§Ü‡§µ‡•á‡§¶‡§®‡•ã‡§Ç ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§î‡§∞ ‡§®‡§ø‡§ó‡§∞‡§æ‡§®‡•Ä ‡§ï‡§∞‡•á‡§Ç</p>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg overflow-hidden fade-in">
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•ç‡§∞‡§Æ‡§æ‡§Ç‡§ï</th>
                                <th>‡§Ü‡§µ‡•á‡§¶‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                                <th>‡§™‡§ø‡§§‡§æ/‡§™‡§§‡§ø ‡§ï‡§æ ‡§®‡§æ‡§Æ</th>
                                <th>‡§∏‡•á‡§µ‡§æ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</th>
                                <th class="hidden md:table-cell">‡§ú‡§ø‡§≤‡§æ</th>
                                <th>‡§∏‡•ç‡§•‡§ø‡§§‡§ø</th>
                                <th class="hidden md:table-cell">‡§Ü‡§µ‡•á‡§¶‡§® ‡§§‡§ø‡§•‡§ø</th>
                                <th>‡§ï‡§æ‡§∞‡•ç‡§∞‡§µ‡§æ‡§à</th>
                            </tr>
                        </thead>
                        <tbody id="applicationsTableBody">
                            <tr>
                                <td colspan="8" class="text-center py-12 text-gray-500">
                                    <i class="fas fa-spinner fa-spin text-3xl mb-3"></i>
                                    <p class="text-lg font-medium">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- JAVASCRIPT -->
<script type="module">
// ============================================
// FIREBASE CONFIGURATION - FIXED VERSION
// ============================================
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
import { 
    getFirestore, 
    collection, 
    onSnapshot, 
    doc, 
    getDoc, 
    getDocs, 
    updateDoc,
    setDoc,
    query, 
    orderBy, 
    limit,
    where,
    addDoc,
    serverTimestamp,
    deleteDoc,
    writeBatch
} from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
import { 
    getAuth, 
    onAuthStateChanged, 
    signOut,
    updateProfile,
    updateEmail
} from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

// ============================================
// CORRECT FIREBASE CONFIG
// ============================================
const firebaseConfig = {
    apiKey: "AIzaSyA-iZvVroV-H6aRs7X-mlnt_ra3_vnaNzg",
    authDomain: "allinone-mp.firebaseapp.com",
    projectId: "allinone-mp",
    storageBucket: "allinone-mp.firebasestorage.app",
    messagingSenderId: "826932399310",
    appId: "1:826932399310:web:a09b1b8a29a30d3f24f1ba",
    measurementId: "G-3SD0LDNLR6"
};

// Global Variables
let app, db, auth;
let allApplications = [];
let currentUser = null;
let isDataLoaded = false;
let applicationsChart, statusChart;

// ============================================
// INITIALIZE FIREBASE
// ============================================
function initFirebase() {
    try {
        console.log("üî• Initializing Firebase...");
        app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        auth = getAuth(app);
        
        console.log("‚úÖ Firebase initialized successfully!");
        
        // Check auth state
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                console.log("‚úÖ User authenticated:", user.email);
                document.getElementById('firebaseStatus').textContent = "‡§ï‡§®‡•á‡§ï‡•ç‡§ü‡•á‡§° ‚úì";
                document.getElementById('firebaseStatus').className = "font-bold text-green-600";
                
                initDashboard();
            } else {
                console.log("‚ùå User not authenticated - Redirecting to login");
                document.getElementById('loadingScreen').style.display = 'none';
                document.getElementById('authErrorScreen').style.display = 'flex';
                
                setTimeout(() => {
                    window.location.href = 'https://allinonemp.harshtiwari.in/adminlogin.html';
                }, 2000);
            }
        });
        
    } catch (error) {
        console.error("‚ùå Firebase Init Error:", error);
        document.getElementById('firebaseStatus').textContent = "‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§µ‡§ø‡§´‡§≤ ‚úó";
        document.getElementById('firebaseStatus').className = "font-bold text-red-600";
        showError("Firebase ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§µ‡§ø‡§´‡§≤: " + error.message);
    }
}

// ============================================
// INITIALIZE DASHBOARD
// ============================================
function initDashboard() {
    console.log("üìä Initializing Dashboard...");
    updateLoadingStatus("‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...");
    
    let progress = 15;
    const interval = setInterval(() => {
        progress += Math.floor(Math.random() * 15) + 5;
        if (progress > 95) progress = 95;
        document.getElementById('loadingProgress').style.width = `${progress}%`;
        document.getElementById('progressText').textContent = `${progress}%`;
        
        if (progress > 90) {
            clearInterval(interval);
            setTimeout(() => {
                document.getElementById('loadingProgress').style.width = "100%";
                document.getElementById('progressText').textContent = "100%";
                setTimeout(hideLoading, 300);
            }, 500);
        }
    }, 400);
    
    setupRealtimeListeners();
    initUI();
}

// ============================================
// SETUP UI
// ============================================
function initUI() {
    const now = new Date();
    document.getElementById('currentDate').textContent = now.toLocaleDateString('hi-IN', {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    if (currentUser) {
        const displayName = currentUser.displayName || currentUser.email?.split('@')[0] || '‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§ï';
        document.getElementById('adminName').textContent = displayName;
        document.getElementById('sidebarAdminName').textContent = displayName;
        document.getElementById('welcomeAdminName').textContent = displayName;
        document.getElementById('adminEmail').textContent = currentUser.email || '';
        document.getElementById('topBarAvatar').textContent = displayName.charAt(0).toUpperCase();
    }
    
    initCharts();
}

// ============================================
// SETUP REALTIME LISTENERS
// ============================================
function setupRealtimeListeners() {
    console.log("üëÇ Setting up real-time listeners...");
    updateLoadingStatus("‡§∞‡•Ä‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§°‡•á‡§ü‡§æ ‡§∏‡§ø‡§Ç‡§ï ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...");
    
    try {
        const applicationsCol = collection(db, 'applications');
        const q = query(applicationsCol, orderBy('createdAt', 'desc'), limit(100));
        
        onSnapshot(q, (snapshot) => {
            console.log(`üì• Received ${snapshot.docs.length} documents from Firebase`);
            
            allApplications = snapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data(),
                createdAt: doc.data().createdAt?.toDate ? doc.data().createdAt.toDate() : new Date()
            }));
            
            console.log("‚úÖ Applications data loaded:", allApplications.length);
            
            renderDashboardTable(allApplications);
            renderApplicationsTable(allApplications);
            updateStats(allApplications);
            updateCharts(allApplications);
            
            if (!isDataLoaded) {
                isDataLoaded = true;
                console.log("‚úÖ Initial data load complete!");
            }
        }, (error) => {
            console.error("‚ùå Error in real-time listener:", error);
            showError("‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: " + error.message);
        });
        
    } catch (error) {
        console.error("‚ùå Error setting up listeners:", error);
        showError("Listener ‡§∏‡•á‡§ü‡§Ö‡§™ ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: " + error.message);
    }
}

// ============================================
// RENDER DASHBOARD TABLE
// ============================================
function renderDashboardTable(data) {
    const tbody = document.getElementById('dataTable');
    if (!data || data.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="7" class="py-12">
                    <div class="empty-state">
                        <i class="fas fa-inbox empty-icon"></i>
                        <h3 class="empty-title">‡§ï‡•ã‡§à ‡§Ü‡§µ‡•á‡§¶‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</h3>
                        <p class="empty-message">‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡§Æ‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§</p>
                        <button onclick="showSection('newApplication')" class="btn-primary mt-4 px-6 py-3">
                            <i class="fas fa-plus"></i> ‡§®‡§Ø‡§æ ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                        </button>
                    </div>
                </td>
            </tr>
        `;
        return;
    }
    
    let html = '';
    data.slice(0, 10).forEach((item) => {
        const appNo = item.applicationNumber || `AIO-MP-${item.id.substring(0, 8).toUpperCase()}`;
        const name = item.applicantName || item.name || "‡§Ö‡§ú‡•ç‡§û‡§æ‡§§";
        const service = item.serviceType || "samagra";
        const mobile = item.mobileNumber || item.mobile || "N/A";
        const date = formatDate(item.createdAt);
        const status = item.status || 'pending';
        
        let statusClass = status === 'complete' ? 'status-complete' : 
                         status === 'reject' ? 'status-reject' : 
                         status === 'processing' ? 'status-processing' : 'status-pending';
        
        let statusText = status === 'complete' ? '‡§™‡•Ç‡§∞‡•ç‡§£' : 
                        status === 'reject' ? '‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§' : 
                        status === 'processing' ? '‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó' : '‡§≤‡§Ç‡§¨‡§ø‡§§';
        
        html += `
        <tr class="table-row">
            <td class="font-mono font-bold text-blue-800">${appNo}</td>
            <td class="font-bold text-gray-800">${name}</td>
            <td><span class="service-badge">${getServiceName(service)}</span></td>
            <td class="hidden md:table-cell font-medium">${mobile}</td>
            <td class="hidden md:table-cell text-gray-600">${date}</td>
            <td>
                <span class="status-badge ${statusClass}">
                    <i class="fas ${status === 'complete' ? 'fa-check-circle' : status === 'reject' ? 'fa-times-circle' : status === 'processing' ? 'fa-cog' : 'fa-clock'}"></i>
                    ${statusText}
                </span>
            </td>
            <td>
                <div class="flex items-center gap-2">
                    <button onclick="alert('View: ${item.id}')" class="action-btn action-view">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button onclick="alert('Edit: ${item.id}')" class="action-btn action-edit">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button onclick="deleteApplication('${item.id}')" class="action-btn action-delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </td>
        </tr>
        `;
    });
    
    tbody.innerHTML = html;
    document.getElementById('totalRecords').textContent = data.length;
}

// ============================================
// RENDER APPLICATIONS TABLE
// ============================================
function renderApplicationsTable(data) {
    const tbody = document.getElementById('applicationsTableBody');
    if (!data || data.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="8" class="py-12 text-center text-gray-500">
                    <i class="fas fa-inbox text-4xl mb-3"></i>
                    <p class="text-lg font-medium">‡§ï‡•ã‡§à ‡§Ü‡§µ‡•á‡§¶‡§® ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</p>
                </td>
            </tr>
        `;
        return;
    }
    
    let html = '';
    data.forEach((item) => {
        const appNo = item.applicationNumber || `AIO-MP-${item.id.substring(0, 8).toUpperCase()}`;
        const name = item.applicantName || item.name || "‡§Ö‡§ú‡•ç‡§û‡§æ‡§§";
        const fatherName = item.fatherName || item.guardianName || "-";
        const service = item.serviceType || "samagra";
        const district = item.district || "bhopal";
        const date = formatDate(item.createdAt);
        const status = item.status || 'pending';
        
        let statusClass = status === 'complete' ? 'status-complete' : 
                         status === 'reject' ? 'status-reject' : 
                         status === 'processing' ? 'status-processing' : 'status-pending';
        
        let statusText = status === 'complete' ? '‡§™‡•Ç‡§∞‡•ç‡§£' : 
                        status === 'reject' ? '‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§' : 
                        status === 'processing' ? '‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó' : '‡§≤‡§Ç‡§¨‡§ø‡§§';
        
        html += `
        <tr class="table-row">
            <td class="font-mono font-bold text-blue-800">${appNo}</td>
            <td class="font-bold text-gray-800">${name}</td>
            <td class="text-gray-700">${fatherName}</td>
            <td><span class="service-badge">${getServiceName(service)}</span></td>
            <td class="hidden md:table-cell text-gray-700 font-medium">${getDistrictName(district)}</td>
            <td>
                <select class="form-control text-sm py-1 ${statusClass}" style="border-radius: 20px; padding: 4px 12px;" onchange="quickStatusChange('${item.id}', this.value)">
                    <option value="pending" ${status === 'pending' ? 'selected' : ''}>‡§≤‡§Ç‡§¨‡§ø‡§§</option>
                    <option value="processing" ${status === 'processing' ? 'selected' : ''}>‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó</option>
                    <option value="complete" ${status === 'complete' ? 'selected' : ''}>‡§™‡•Ç‡§∞‡•ç‡§£</option>
                    <option value="reject" ${status === 'reject' ? 'selected' : ''}>‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§</option>
                </select>
            </td>
            <td class="hidden md:table-cell text-gray-600">${date}</td>
            <td>
                <div class="flex items-center gap-2">
                    <button onclick="alert('View: ${item.id}')" class="action-btn action-view">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button onclick="alert('Edit: ${item.id}')" class="action-btn action-edit">
                        <i class="fas fa-edit"></i>
                    </button>
                </div>
            </td>
        </tr>
        `;
    });
    
    tbody.innerHTML = html;
}

// ============================================
// UPDATE STATISTICS
// ============================================
function updateStats(data) {
    const total = data.length;
    const pending = data.filter(a => a.status === 'pending' || !a.status).length;
    const complete = data.filter(a => a.status === 'complete').length;
    const rejected = data.filter(a => a.status === 'reject').length;
    
    document.getElementById('statTotal').textContent = total.toLocaleString();
    document.getElementById('statPending').textContent = pending.toLocaleString();
    document.getElementById('statComplete').textContent = complete.toLocaleString();
    document.getElementById('statRejected').textContent = rejected.toLocaleString();
    document.getElementById('statPendingCount').textContent = pending;
}

// ============================================
// INITIALIZE CHARTS
// ============================================
function initCharts() {
    const ctx1 = document.getElementById('applicationsChart')?.getContext('2d');
    const ctx2 = document.getElementById('statusChart')?.getContext('2d');
    
    if (!ctx1 || !ctx2) return;
    
    applicationsChart = new Chart(ctx1, {
        type: 'line',
        data: {
            labels: ['‡§ú‡§®', '‡§´‡§∞', '‡§Æ‡§æ‡§∞‡•ç‡§ö', '‡§Ö‡§™‡•ç‡§∞‡•à', '‡§Æ‡§à', '‡§ú‡•Ç‡§®', '‡§ú‡•Å‡§≤‡§æ', '‡§Ö‡§ó', '‡§∏‡§ø‡§§'],
            datasets: [{
                label: '‡§Ü‡§µ‡•á‡§¶‡§®',
                data: [65, 59, 80, 81, 56, 55, 40, 78, 86],
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                borderWidth: 3,
                fill: true,
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } }
        }
    });
    
    statusChart = new Chart(ctx2, {
        type: 'doughnut',
        data: {
            labels: ['‡§™‡•Ç‡§∞‡•ç‡§£', '‡§≤‡§Ç‡§¨‡§ø‡§§', '‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó', '‡§Ö‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§'],
            datasets: [{
                data: [75, 15, 7, 3],
                backgroundColor: ['#22c55e', '#f59e0b', '#3b82f6', '#ef4444'],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false
        }
    });
}

function updateCharts(data) {
    if (!statusChart) return;
    const pending = data.filter(a => a.status === 'pending' || !a.status).length;
    const complete = data.filter(a => a.status === 'complete').length;
    const rejected = data.filter(a => a.status === 'reject').length;
    const processing = data.filter(a => a.status === 'processing').length;
    
    statusChart.data.datasets[0].data = [complete, pending, processing, rejected];
    statusChart.update();
}

// ============================================
// FORM SUBMISSION
// ============================================
document.getElementById('applicationForm')?.addEventListener('submit', async function(e) {
    e.preventDefault();
    
    try {
        const formData = {
            applicantName: document.getElementById('applicantName').value,
            fatherName: document.getElementById('fatherName').value,
            mobileNumber: document.getElementById('mobileNumber').value,
            aadharNumber: document.getElementById('aadharNumber').value,
            dob: document.getElementById('dob').value,
            gender: document.getElementById('gender').value,
            serviceType: document.getElementById('serviceType').value,
            district: document.getElementById('district').value,
            address: document.getElementById('address').value,
            pincode: document.getElementById('pincode').value,
            email: document.getElementById('email').value,
            status: 'pending',
            createdAt: serverTimestamp(),
            updatedAt: serverTimestamp()
        };
        
        const docRef = await addDoc(collection(db, 'applications'), formData);
        console.log("‚úÖ Application submitted:", docRef.id);
        showToast('‚úì ‡§Ü‡§µ‡•á‡§¶‡§® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ú‡§Æ‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ!', 'success');
        this.reset();
        showSection('dashboard');
    } catch (error) {
        console.error("‚ùå Error submitting application:", error);
        showToast("‡§Ü‡§µ‡•á‡§¶‡§® ‡§ú‡§Æ‡§æ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: " + error.message, 'error');
    }
});

// ============================================
// STATUS UPDATE
// ============================================
window.quickStatusChange = async function(id, newStatus) {
    try {
        await updateDoc(doc(db, 'applications', id), {
            status: newStatus,
            updatedAt: serverTimestamp()
        });
        console.log("‚úÖ Status updated for:", id);
    } catch (error) {
        console.error("‚ùå Error updating status:", error);
        alert("‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø!");
    }
};

// ============================================
// DELETE APPLICATION
// ============================================
window.deleteApplication = async function(id) {
    if (!confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§Ü‡§µ‡•á‡§¶‡§® ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) return;
    
    try {
        await deleteDoc(doc(db, 'applications', id));
        console.log("‚úÖ Application deleted:", id);
        showToast('‡§Ü‡§µ‡•á‡§¶‡§® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ', 'success');
    } catch (error) {
        console.error("‚ùå Error deleting application:", error);
        showToast('‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ' + error.message, 'error');
    }
};

// ============================================
// NAVIGATION & UI FUNCTIONS
// ============================================
window.showSection = function(sectionId) {
    document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
    const section = document.getElementById(sectionId);
    if (section) section.classList.add('active');
    
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('onclick')?.includes(sectionId)) {
            item.classList.add('active');
        }
    });
    
    window.scrollTo(0, 0);
};

window.toggleSidebar = function() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');
    
    sidebar.classList.toggle('collapsed');
    mainContent.classList.toggle('sidebar-collapsed');
    
    if (window.innerWidth < 768) {
        sidebar.classList.toggle('active');
    }
};

window.logout = function() {
    if (confirm("‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?")) {
        signOut(auth).then(() => {
            showToast('‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü ‡§π‡•ã ‡§ó‡§è', 'success');
            setTimeout(() => {
                window.location.href = 'https://allinonemp.harshtiwari.in/adminlogin.html';
            }, 1000);
        }).catch(err => console.error(err));
    }
};

window.refreshData = function() {
    showToast('‡§°‡•á‡§ü‡§æ ‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', 'info');
    setupRealtimeListeners();
};

window.resetForm = function() {
    document.getElementById('applicationForm')?.reset();
    showToast('‡§´‡•â‡§∞‡•ç‡§Æ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ', 'success');
};

// ============================================
// HELPER FUNCTIONS
// ============================================
function formatDate(date) {
    if (!date) return "-";
    try {
        if (date.toDate) date = date.toDate();
        const d = new Date(date);
        return d.toLocaleDateString('hi-IN', {
            day: '2-digit',
            month: 'long',
            year: 'numeric'
        });
    } catch (e) {
        return "-";
    }
}

function getServiceName(type) {
    const map = {
        'samagra': '‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§Ü‡§à‡§°‡•Ä',
        'mpbhoj': '‡§è‡§Æ‡§™‡•Ä ‡§≠‡•ã‡§ú ‡§Ø‡•ã‡§ú‡§®‡§æ',
        'scholarship': '‡§õ‡§æ‡§§‡•ç‡§∞‡§µ‡•É‡§§‡•ç‡§§‡§ø',
        'pension': '‡§™‡•á‡§Ç‡§∂‡§®',
        'housing': '‡§Ü‡§µ‡§æ‡§∏'
    };
    return map[type] || '‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§Ü‡§à‡§°‡•Ä';
}

function getDistrictName(district) {
    const map = {
        'bhopal': '‡§≠‡•ã‡§™‡§æ‡§≤',
        'indore': '‡§á‡§Ç‡§¶‡•å‡§∞',
        'jabalpur': '‡§ú‡§¨‡§≤‡§™‡•Å‡§∞',
        'gwalior': '‡§ó‡•ç‡§µ‡§æ‡§≤‡§ø‡§Ø‡§∞',
        'ujjain': '‡§â‡§ú‡•ç‡§ú‡•à‡§®',
        'sagar': '‡§∏‡§æ‡§ó‡§∞',
        'ratlam': '‡§∞‡§§‡§≤‡§æ‡§Æ',
        'satna': '‡§∏‡§§‡§®‡§æ'
    };
    return map[district] || district || '-';
}

function updateLoadingStatus(msg) {
    const el = document.getElementById('loadingStatus');
    if (el) el.innerHTML = `<i class="fas fa-sync-alt fa-spin mr-2"></i>${msg}`;
}

function hideLoading() {
    const loader = document.getElementById('loadingScreen');
    if (loader) {
        loader.style.opacity = '0';
        setTimeout(() => loader.style.display = 'none', 500);
    }
}

function showError(msg) {
    console.error(msg);
    const el = document.getElementById('loadingStatus');
    if (el) {
        el.innerHTML = `<i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>${msg}`;
        el.className = "mt-2 text-sm text-red-600 font-bold flex items-center";
    }
}

function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `fixed top-20 right-6 z-50 px-6 py-4 rounded-xl shadow-2xl transform transition-all duration-300 ${
        type === 'success' ? 'bg-green-500' : 
        type === 'error' ? 'bg-red-500' : 
        'bg-blue-500'
    } text-white font-medium flex items-center gap-3`;
    
    toast.innerHTML = `
        <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
        <span>${message}</span>
    `;
    
    document.body.appendChild(toast);
    setTimeout(() => toast.style.transform = 'translateX(0)', 10);
    setTimeout(() => {
        toast.style.transform = 'translateX(400px)';
        setTimeout(() => document.body.removeChild(toast), 300);
    }, 3000);
}

// ============================================
// INITIALIZE ON PAGE LOAD
// ============================================
console.log("üöÄ Starting application...");
initFirebase();

</script>
</body>
</html>
